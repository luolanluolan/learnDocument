# 一、类加载

![image-20191216101701063](C:\Users\l\AppData\Roaming\Typora\typora-user-images\image-20191216101701063.png)

加载、验证、准备、初始化、卸载五个阶段的顺序是确定的，解析截断不一定，在某些情况下可以在初始化之后，比如动态绑定。

```tex
被动引用：
	1.子类引用父类的静态字段，不会导致子类初始化
    2.通过数组定义来引用类，不会触发此类的初始化
    3.常量在编译阶段会存入调用类的常量池中，本质上并没有直接引用到定义常量的类，因此不会触发定义常量的类的初始化。
```



## 1.1、加载

```
 通过一个类的全限定名来获取定义此类的二进制字节流
​ 将这个字节流所代表的静态存储结构转换为方法区的运行时数据结构。
​ 在内存中生成一个代表这个类的java.lang.Class对象，作为方法区这个类的各种数据的访问入口。

加载阶段与连接阶段是交叉进行的，可能加载阶段尚未完成，连接阶段已经开始。开始时间的先后顺序是固定的
```

##  1.2、验证

a)文件格式验证：

```
 是否以魔术0XCAFEBABE开头。
​ 主、次版本号是否在当前虚拟机处理范围之内。
​ 常量池的常量中是否有不被支持的常量类型
​ 指向常量的各种索引值中是否有指向不存在的常量或不符合类型的         常量
​ CONSTANT_Utf8_info型的常量中是否有不符合UTF8编码的数据
​ Class文件中各个部分及文件本身是否有被删除的或附加的其他信息
```

b)元数据验证：

```
 
​ 
```

c)字节码验证：

```
 
​ 
```

d)符号引用验证：

```
 
```